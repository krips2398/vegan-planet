# Results
```{r}
library(dplyr)
library(ggplot2)
library(forcats)
library(ggmap)
library(tidyverse)
library(choroplethr)
library(vcd)
```

## Inconvience because of veganism
```{r fig.height=10,fig.width=15}
df <- read_csv('project_data/inconvience_reasons.csv')
tidydf <- df %>%
     gather(key = "opinion", value = "Counts", "Disagree", "Agree", "Neither agree nor disagree")
ggplot(
      tidydf,
      aes(Counts, 
          fct_reorder2(reason, opinion=="Disagree", Counts, .desc = FALSE),
          color = opinion)) +
      geom_point(aes(size=1)) + 
      ggtitle("Inconvience because of veganism") +
      ylab("") +
      theme_grey(16) +
      theme(plot.title = element_text(hjust = 0.5)) +
      guides(size=FALSE) 

options(repr.P.width=4,repr.P.height=10)
```

## Number of restuarants in each region
```{r fig.height=10, fig.width=10}
df_state <- read.csv("project_data/states_grouped_1.csv")
state_choropleth(df_state, title = "Number of Vegetarian restaurants in every state", legend="Counts") + scale_fill_brewer(palette=2)
```


## How many vegetarian restuarants are opened from 2014-2018

```{r}
df <- read_csv('project_data/timeseries_opening_of_restuarants.csv')
df <- df[order(df$date),]
df$tmp <- "-01"
df$date <- paste0(df$date,df$tmp)
df$date <- as.Date(df$date, format="%Y-%m-%d")
df = df[-1,]
ggplot(df, aes(date, counts, group = 1)) +
         geom_point(color="black") + 
         geom_line(colour="black") +
         geom_smooth(method ="loess",span = .3,se=FALSE, color="darkgreen") +
         scale_x_date(date_breaks = "3 month", date_labels = "%b %y") +
         labs(x = "Date", y = "Number of Vegetarain restaurants", title = "Number of Vegetarian restaurants opened over time")
```

## Length vs. Transition
```{r fig.height=10, fig.width=10}
df <- read_csv("project_data/age_transition_legth.csv")
#df$ALLTRANSITION <- as.integer(df$ALLTRANSITION)
#df$ALLLENGTH <- as.integer(df$ALLLENGTH)

mosaic(Time_for_transition ~ Length_of_veganism, labeling = vcd::labeling_border(rot_labels = c(0, 0)), df, direction=c("v","h"),main='Mosaic plot for Length and Transition to veganism')
```

## Bar plot
```{r}
df <- read_csv("project_data/age_difficulty_during_transition.csv")
df <- df[c("Age","difficulty_during_transition")]
df$difficulty_during_transition <- as.factor(df$difficulty_during_transition)
ggplot(df, aes(fct_infreq(difficulty_during_transition))) +
  geom_bar(color="darkgreen",fill = "palegreen3") + 
  ggtitle("What age group is facing a lot of difficulty during transition") +
  xlab("Opinion")+
  ylab("Count")+
  facet_wrap('Age') +
  theme_grey(14) + 
  theme(text = element_text(size=9), legend.position = "none", plot.title = element_text(hjust = 0.5))
```